---
title: "Exploratory Data Analysis (EDA) - AmeriCorps"
author: "GWU Intro to Data Science -- DATS 6101 Group8"
# date: "today"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r init, include=F}
# The package "ezids" (EZ Intro to Data Science) includes a lot of the helper functions we developed for the course. 
# Some of the frequently used functions are loadPkg(), xkabledply(), xkablesummary(), uzscale(), etc.
# Once installed, load the library.
library(ezids)
```


```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "markup", message = F)
options(scientific=T, digits = 3) 
```

```{r}
library(dplyr)
library(ggplot2)
library(tidyr)
```


```{r}
americorps <- read.csv("/home/anusha/workspace/Data science/AmeriCorps-Volunteers/AmeriCorps_Participant_Demographics_Data.csv", header =TRUE)
```


```{r}
dem_cat_subset <- 'Race'
amco <- americorps %>%
  filter(dem_cat == dem_cat_subset)

time_period_subset <- '2022'
amco <- amco %>%
  filter(time_period == time_period_subset)

amco <- amco %>%
  filter(!program_office %in% c("All AmeriCorps Members", "AmeriCorps Member Programs (no NCCC)", "AmeriCorps Seniors (All)"))

amco <- amco %>%
  filter(!dem_group %in% c("Racially Diverse (Non-White)"))
```

```{r}
amco$geography<-as.factor(amco$geography)
amco$dem_cat<-as.factor(amco$dem_cat)
amco$dem_group<-as.factor(amco$dem_group)
amco$program_office<-as.factor(amco$program_office)
amco$service_region<-as.factor(amco$service_region)
amco$state<-as.factor(amco$state)
amco$time_period<-as.factor(amco$time_period)
```

**1. Which program offices are most effective in engaging a diverse range of participants?**
```{r}
```

**2. How does the representation of different demographic groups compare to their proportions in the general population?**
```{r}
```
**3. Which groups are overrepresented or underrepresented in AmeriCorps?**
    ```{r}
```
**4. How do participation rates compare between different programs within the same service region?**
```{r}
```
**5. What is the racial composition of the volunteers?**
```{r}
#I think in this first chunk, need to replace amco_r2022_noNW with amco because that's how it's subsetted at the beginning? Also think this question should go to #1. I reordered the question on the ppt as well so they make more sense (ie go from least to most specific)
national <- amco_r2022_noNW %>%
  filter(geography == "National")
print(national)

program_MSY_national <- national %>%
  group_by(program_office) %>%
  summarise (total_dem_group = sum(count_dem_group))
print(program_MSY_national)

race_program_national <- aggregate(count_dem_group ~ program_office + dem_group, data = national, sum)
print(race_program_national)

group_MSY_national <- aggregate(count_dem_group ~ dem_group, data = national, sum)
total_MSY_national <- sum(group_MSY_national$count_dem_group)
group_MSY_national$percentage <- (group_MSY_national$count_dem_group / total_MSY_national) * 100
print(group_MSY_national)

#total MSY bar chart
ggplot(group_MSY_national, aes(x = dem_group, y = count_dem_group, fill = dem_group)) +
  geom_bar(stat = "identity", width = 0.5) +
  labs(title = "AmeriCorps Participation of Race by Member Service Years (MSY)", x = "Race", y = "MSY") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") + 
  geom_text(aes(label = count_dem_group), vjust = 0, size = 3.5) +
  theme(axis.text.x = element_blank()) +
  theme(plot.title = element_text(size = 20, face = "bold", hjust = 0),
        axis.title = element_text(size = 16, face = "bold"),
        axis.text.x = element_blank(),
        axix.text.y = element_text(size = 10))

#bar chart w %MSY
ggplot(group_MSY_national, aes(x = dem_group, y = percentage, fill = dem_group)) +
  geom_bar(stat = "identity", width = 0.6) +
  labs(title = "Race Distribution by Percentage of Member Service Years (MSY)", x = "Race", y = "MSY(%)") +
  theme_minimal() +
  scale_fill_brewer(palette = "Set2") + 
  geom_text(aes(label = round(percentage, 1)), vjust = 0, size = 3) +
  theme(axis.text.x = element_blank()) +
  theme(legend.position = "none",
        plot.title = element_text(size = 12, face = "bold", hjust = 0),
        axis.title = element_text(size = 10, face = "bold"),
        axis.text.x = element_text(size = 6, angle = 90, vjust = -3),
        axix.text.y = element_text(size = 10))+
  scale_y_continuous(breaks = seq(0, 100, by = 15))
```
**6.Are some racial groups more engaged in volunteer activities within specific states or program offices?**
```{r}
```
